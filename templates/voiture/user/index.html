{% extends "voiture/user/navUser.html" %}
{% load static %}

{% block content %}

<main class="container mx-auto mt-5 px-4">

  <!-- ================= HERO SECTION ================= -->
  <section
      class="relative h-[600px] rounded-xl overflow-hidden shadow-lg animate-section"
      style="background-image: linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)), url('{% static "images/home2.jpg" %}');
             background-size: cover; background-position: center;"
  >
      <div class="relative h-full flex items-center">
          <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-2 gap-6">

              <!-- SEARCH CARD -->
              <div class="bg-white p-6 rounded-2xl shadow-xl max-w-md
                          transition-all duration-700 ease-out
                          animate-item"
                   data-delay="100">
                  <h2 class="text-gray-700 text-xl font-bold mb-4 flex items-center gap-2">
                      üîç Trouver une voiture
                  </h2>

                  <form method="get" action="{% url 'user_home' %}" class="space-y-3">
                      <input
                          type="text"
                          name="q"
                          placeholder="Nom, marque ou n¬∞ de ch√¢ssis"
                          value="{{ request.GET.q|default_if_none:'' }}"
                          class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-500 transition"
                      >
                      <button
                          type="submit"
                          class="w-full p-3 bg-red-600 text-white font-bold rounded-lg
                                 hover:bg-red-700 transition-all duration-300 hover:scale-105"
                      >
                          Rechercher ‚Üí
                      </button>
                  </form>
              </div>

              <!-- HERO TEXT -->
              <div class="text-center md:text-left animate-item" data-delay="200">
                  <h1 class="text-white text-5xl md:text-6xl font-extrabold drop-shadow-2xl">
                      Roulez vers l‚Äôavenir avec <span class="text-red-600">KASACO</span>
                  </h1>
                  <p class="mt-6 text-gray-300 text-lg md:text-xl">
                      L‚Äôinnovation au bout de vos roues.
                  </p>
                  <button
                      class="mt-8 px-6 py-3 bg-red-600 text-white font-semibold rounded-lg shadow-lg
                             transform hover:scale-110 transition-transform duration-300"
                  >
                      D√©couvrez nos voitures
                  </button>
              </div>

          </div>
      </div>
  </section>

    {% if voitures %}
  <section class="max-w-7xl mx-auto px-6 py-12 animate-section">
      <h2 class="text-3xl font-bold mb-6 animate-item">R√©sultats de votre recherche</h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
          {% for voiture in voitures %}
          <div class="bg-white rounded-2xl shadow overflow-hidden
                      transition-all duration-500 hover:-translate-y-2 hover:shadow-2xl
                      animate-item">
              <img src="{% if voiture.photo %}{{ voiture.photo.url }}{% else %}{% static 'images/default-car.jpg' %}{% endif %}"
                   class="w-full h-64 object-cover transition-transform duration-500 hover:scale-110">
              <div class="p-4">
                  <h3 class="text-xl font-bold">{{ voiture.modele.nom }} - {{ voiture.marque.nom }}</h3>
                  <p class="text-red-600 font-semibold mt-2">Prix : {{ voiture.prix }} $</p>
                   <a href="{% url 'details' voiture.id %}"
           class="mt-4 inline-flex items-center justify-center gap-2
                  bg-gradient-to-r from-red-600 to-red-700
                  text-white px-4 py-2 rounded-xl font-semibold
                  shadow-lg hover:shadow-red-500/40
                  hover:scale-105 transition">
          <i class="bi bi-eye-fill"></i>
          Voir d√©tails
        </a>
              </div>
          </div>
          {% endfor %}
      </div>
  </section>
  {% endif %}

  <!-- ================= MARQUES ================= -->
  <section class="py-16 bg-gradient-to-b from-indigo-50 to-pink-50 overflow-hidden">
      <h2 class="text-3xl font-bold mb-10 text-center animate-item" id="marques-title">
          Choisir une marque
      </h2>

      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 px-4" id="marques-grid">
          {% for marque in marques %}
          <a href="{% url 'modele_auth' marque.id %}" class="group">
              <div class="rounded-xl p-2 flex flex-col items-center justify-center
                          text-white shadow-md transition-all duration-500
                          animate-item marque-card
                          bg-gradient-to-br from-orange-400 via-yellow-300 to-pink-400
                          hover:scale-110 hover:shadow-lg hover:brightness-110">
                  {% if marque.logo %}
                  <img src="{{ marque.logo.url }}" class="h-12 w-12 object-contain mb-2 transition-transform duration-300 group-hover:scale-125">
                  {% else %}
         <div id="marque-{{ marque.id }}"
     class="h-12 w-12 bg-white rounded-full flex items-center justify-center mb-2 text-xs font-semibold text-gray-800 shadow overflow-hidden text-center">
    {{ marque.nom }}<span class='text-black'>({{ marque.id }}_)</span>
</div>

                  {% endif %}
              </div>
          </a>
          {% endfor %}
      </div>
  </section>

  <!-- ================= MODELES ================= -->
  <section class="max-w-7xl mx-auto px-6 py-20 animate-section">
      <h2 class="text-4xl font-extrabold mb-12 text-center text-gradient animate-item"
          style="background: linear-gradient(90deg, #FF6B6B, #FFD93D, #6BCB77); -webkit-background-clip: text; color: transparent;">
          Parcourir par mod√®le
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
          {% for modele in modeles %}
          <div class="rounded-2xl overflow-hidden shadow-lg
                      bg-gradient-to-br from-purple-400 via-pink-400 to-yellow-300
                      transition-transform duration-500 hover:scale-105 hover:rotate-1 hover:shadow-2xl
                      animate-item cursor-pointer">
              {% if modele.image %}
              <img src="{{ modele.image.url }}" class="w-full h-48 object-cover border-b-4 border-white">
              {% endif %}
              <div class="p-4">
                  <h3 class="text-xl font-bold text-black text-center">{{ modele.nom }}</h3>
              </div>
          </div>
          {% endfor %}
      </div>
  </section>

  <!-- ================= POPULAIRES ================= -->
  <section class="max-w-7xl mx-auto px-6 py-20 animate-section">
      <h2 class="text-4xl font-extrabold mb-12 text-center text-gradient animate-item"
          style="background: linear-gradient(90deg, #FF6B6B, #FFD93D, #6BCB77); -webkit-background-clip: text; color: transparent;">
          Voitures les plus populaires
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
          {% for voiture in voitures_populaires %}
          <div class="rounded-2xl overflow-hidden shadow-lg
                      bg-gradient-to-br from-blue-400
                      transition-transform duration-500 hover:scale-105 hover:-translate-y-2 hover:shadow-2xl
                      animate-item cursor-pointer">
              <img src="{% if voiture.photo %}{{ voiture.photo.url }}{% else %}{% static 'images/default-car.jpg' %}{% endif %}"
                   class="w-full h-64 object-cover border-b-4 border-white">
                  <div class="p-4 text-center   bg-amber-400">
                  <h3 class="text-lg font-semibold text-black">{{voiture.modele.nom}}</h3>
              </div>
          </div>
          {% endfor %}
      </div>
  </section>


<!-- ================= FLASH MESSAGES ================= -->
<div id="messages-container" class="fixed top-20 right-6 space-y-3 z-50">
  {% if messages %}
    {% for message in messages %}
      <div
        class="px-5 py-3 rounded-xl shadow-xl text-sm font-medium
               bg-gradient-to-r from-green-400 via-green-300 to-emerald-400
               text-green-900 backdrop-blur-lg
               transform transition-all duration-500 opacity-0 translate-x-10"
        id="msg{{ forloop.counter }}">
        <i class="bi bi-check-circle-fill mr-2"></i>
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
</div>

<!-- ================= FOOTER ================= -->
<footer class="bg-gradient-to-br from-[#0B1220] via-[#0E1A2F] to-[#0B1220] text-gray-300 mt-20">
  <div class="max-w-7xl mx-auto px-6 py-20
              grid grid-cols-1 md:grid-cols-3 gap-12 animate-fadeUp">

    <div class="space-y-4 transform transition hover:-translate-y-1 hover:scale-105">
      <h5 class="font-bold text-lg text-orange-400 uppercase tracking-wider">
        KARINZI SAB COMPANY "KASACO"
      </h5>
      <ul class="space-y-2 text-sm">
        <li class="flex items-center"><i class="bi bi-shop text-orange-400 mr-3 text-xl"></i>Vente & importation</li>
        <li class="flex items-center"><i class="bi bi-globe2 text-orange-400 mr-3 text-xl"></i>Vente en ligne</li>
        <li class="flex items-center"><i class="bi bi-car-front-fill text-orange-400 mr-3 text-xl"></i>Garages</li>
      </ul>
    </div>

    <div class="space-y-4 transform transition hover:-translate-y-1 hover:scale-105">
      <h5 class="font-bold text-lg text-orange-400 uppercase tracking-wider">Contact</h5>
      <ul class="space-y-2 text-sm">
        <li class="flex items-center"><i class="bi bi-envelope-fill text-orange-400 mr-3 text-xl"></i>nduwamungudism7@gmail.com</li>
        <li class="flex items-center"><i class="bi bi-whatsapp text-green-500 mr-3 text-xl"></i>
          <a href="https://wa.me/25769080278" target="_blank" class="hover:text-green-400 transition">+257 69 080 278</a>
        </li>
        <li class="flex items-center"><i class="bi bi-telephone-fill text-blue-400 mr-3 text-xl"></i>+257 75 123 456</li>
      </ul>
    </div>

    <div class="space-y-4 transform transition hover:-translate-y-1 hover:scale-105">
      <h5 class="font-bold text-lg text-orange-400 uppercase tracking-wider">Suivez-nous</h5>
      <div class="flex space-x-5 text-3xl">
        <a href="#" class="text-blue-600 hover:text-blue-400 transition"><i class="bi bi-facebook"></i></a>
        <a href="#" class="text-sky-400 hover:text-sky-300 transition"><i class="bi bi-twitter"></i></a>
        <a href="#" class="text-pink-500 hover:text-pink-400 transition"><i class="bi bi-instagram"></i></a>
        <a href="#" class="text-green-500 hover:text-green-400 transition"><i class="bi bi-whatsapp"></i></a>
      </div>
    </div>

  </div>
  <div class="border-t border-white/10"></div>
  <div class="text-center py-6 text-sm text-gray-400">
    ¬© 2025‚Äì2026 <span class="text-white font-semibold">KASACO</span> / Par ‚Äî Programmeur-Passionn√©
  </div>
</footer>

<!-- ================= ANIMATIONS JS ================= -->
<script>
document.addEventListener("DOMContentLoaded", () => {
    // Intersection Observer
    const items = document.querySelectorAll('.animate-item');
    const sections = document.querySelectorAll('.animate-section');

    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if(entry.isIntersecting) entry.target.classList.add('show');
        });
    }, { threshold: 0.15 });

    sections.forEach(sec => observer.observe(sec));
    items.forEach(item => observer.observe(item));

    // Flash messages
    const messages = document.querySelectorAll('#messages-container div');
    messages.forEach((msg, index) => {
        setTimeout(() => { msg.classList.remove('opacity-0','translate-x-10'); }, 150 * index);
        setTimeout(() => { msg.classList.add('opacity-0','translate-x-10'); setTimeout(() => msg.remove(),500); }, 3500 + (150*index));
    });
});
</script>

<!-- ================= ANIMATIONS CSS ================= -->
<style>
.animate-section { opacity: 0; transform: translateY(40px); transition: all 0.8s ease; }
.animate-section.show { opacity: 1; transform: translateY(0); }
.animate-item { opacity: 0; transform: translateY(30px); transition: all 0.7s ease; }
.animate-item.show { opacity: 1; transform: translateY(0); }
</style>

{% endblock %}
